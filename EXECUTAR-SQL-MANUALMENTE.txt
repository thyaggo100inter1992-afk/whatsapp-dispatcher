â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                  â•‘
â•‘   ğŸ—„ï¸ CRIAR TABELAS MANUALMENTE                                   â•‘
â•‘                                                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


Como o psql nÃ£o estÃ¡ no PATH, execute o SQL manualmente:


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OPÃ‡ÃƒO 1 - pgAdmin (Recomendado)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Abra o pgAdmin
2. Conecte no servidor PostgreSQL
3. Clique no banco "whatsapp_dispatcher"
4. Clique em "Query Tool" (Ã­cone de SQL)
5. COPIE E COLE o SQL abaixo
6. Clique em "Execute" (F5)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OPÃ‡ÃƒO 2 - DBeaver / Outro cliente                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Conecte no banco "whatsapp_dispatcher"
2. Abra uma nova query
3. COPIE E COLE o SQL abaixo
4. Execute


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SQL PARA EXECUTAR:                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

-- ============================================
-- SISTEMA DE TEMPLATES QR CONNECT
-- ============================================

-- Tabela principal de templates QR Connect
CREATE TABLE IF NOT EXISTS qr_templates (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL UNIQUE,
    description TEXT,
    type VARCHAR(50) NOT NULL,
    
    -- ConteÃºdo de texto
    text_content TEXT,
    
    -- ConfiguraÃ§Ãµes de Menu Lista
    list_config JSONB,
    
    -- ConfiguraÃ§Ãµes de Menu BotÃµes
    buttons_config JSONB,
    
    -- ConfiguraÃ§Ãµes de Carrossel
    carousel_config JSONB,
    
    -- Metadados
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Ãndices para melhor performance
CREATE INDEX IF NOT EXISTS idx_qr_templates_type ON qr_templates(type);
CREATE INDEX IF NOT EXISTS idx_qr_templates_name ON qr_templates(name);

-- Tabela de mÃ­dias dos templates
CREATE TABLE IF NOT EXISTS qr_template_media (
    id SERIAL PRIMARY KEY,
    template_id INTEGER NOT NULL REFERENCES qr_templates(id) ON DELETE CASCADE,
    media_type VARCHAR(50) NOT NULL,
    
    -- Arquivo salvo localmente
    file_name VARCHAR(255) NOT NULL,
    file_path TEXT NOT NULL,
    file_size BIGINT,
    mime_type VARCHAR(100),
    
    -- Metadados opcionais
    caption TEXT,
    duration INTEGER,
    
    -- EspecÃ­fico para carrossel (qual card)
    carousel_card_index INTEGER,
    
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Ãndices
CREATE INDEX IF NOT EXISTS idx_qr_template_media_template_id ON qr_template_media(template_id);
CREATE INDEX IF NOT EXISTS idx_qr_template_media_type ON qr_template_media(media_type);

-- ComentÃ¡rios explicativos
COMMENT ON TABLE qr_templates IS 'Templates reutilizÃ¡veis do WhatsApp QR Connect';
COMMENT ON COLUMN qr_templates.type IS 'Tipo de mensagem: text, image, video, audio, audio_recorded, document, list, buttons, carousel';
COMMENT ON COLUMN qr_templates.list_config IS 'ConfiguraÃ§Ã£o completa do menu tipo lista';
COMMENT ON COLUMN qr_templates.buttons_config IS 'ConfiguraÃ§Ã£o completa do menu tipo botÃµes';
COMMENT ON COLUMN qr_templates.carousel_config IS 'ConfiguraÃ§Ã£o completa do carrossel';

COMMENT ON TABLE qr_template_media IS 'MÃ­dias anexadas aos templates (arquivos salvos no servidor)';
COMMENT ON COLUMN qr_template_media.file_path IS 'Caminho fÃ­sico do arquivo no servidor';
COMMENT ON COLUMN qr_template_media.carousel_card_index IS 'Ãndice do card no carrossel (0-based), NULL se nÃ£o for carrossel';

-- ============================================
-- VERIFICAR SE FOI CRIADO
-- ============================================

SELECT 'Tabelas criadas com sucesso!' as mensagem;
SELECT table_name FROM information_schema.tables WHERE table_name LIKE 'qr_%';


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… DEPOIS DE EXECUTAR:                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

VocÃª deve ver:
  âœ“ Query retornou sucesso
  âœ“ 2 tabelas listadas: qr_templates e qr_template_media


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”„ PRÃ“XIMO PASSO:                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Agora vocÃª precisa REINICIAR O BACKEND:

  1. VÃ¡ no terminal do backend
  2. Pressione Ctrl+C
  3. Execute: .\INICIAR_BACKEND.bat
  4. Aguarde 10 segundos
  5. Atualize a pÃ¡gina (F5)


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                  â•‘
â•‘  Depois disso, o erro 500 estarÃ¡ resolvido! âœ…                  â•‘
â•‘                                                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•










